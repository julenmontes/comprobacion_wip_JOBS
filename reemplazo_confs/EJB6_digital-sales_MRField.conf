hammurabi: {
	input: {
		type: "parquet"
		paths: ["/data/master/ejb6/data/t_ejb6_digital_sales/"]
		schema.path: ${ARTIFACTORY_UNIQUE_CACHE}"/artifactory/"${SCHEMAS_REPOSITORY}"/schemas/"${COUNTRY}"/ejb6/master/t_ejb6_digital_sales/latest/t_ejb6_digital_sales.input.schema"
		options: {
			overrideSchema: true
			includeMetadataAndDeleted: true
		}
	}

	dataFrameInfo: {
		cutoffDate: ${CUTOFF_DATE}
		subset: "gf_cutoff_date='"${CUTOFF_DATE}"'"
		uuaa: "ejb6"
		targetPathName: "/data/master/ejb6/data/t_ejb6_digital_sales"
		physicalTargetName: "t_ejb6_digital_sales"
	}

	rules : [
		{
			class: "com.datio.hammurabi.rules.validity.NotNullValidationRule"
			config: {
				id: "GL_MVP_t_ejb6_digital_sales_3.1_000"
				column: "g_country_id"
				acceptanceMin: 100
				treatEmptyValuesAsNulls: true
				isCritical: true
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.NotNullValidationRule"
			config: {
				id: "GL_MVP_t_ejb6_digital_sales_3.1_001"
				column: "g_entity_id"
				acceptanceMin: 100
				treatEmptyValuesAsNulls: true
				isCritical: true
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.NotNullValidationRule"
			config: {
				id: "GL_MVP_t_ejb6_digital_sales_3.1_002"
				column: "gf_entity_id"
				acceptanceMin: 100
				treatEmptyValuesAsNulls: true
				isCritical: true
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.NotNullValidationRule"
			config: {
				id: "GL_MVP_t_ejb6_digital_sales_3.1_003"
				column: "g_contract_id"
				acceptanceMin: 100
				treatEmptyValuesAsNulls: true
				isCritical: true
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.NotNullValidationRule"
			config: {
				id: "GL_MVP_t_ejb6_digital_sales_3.1_004"
				column: "g_init_contracting_channel_id"
				acceptanceMin: 100
				treatEmptyValuesAsNulls: true
				isCritical: true
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.NotNullValidationRule"
			config: {
				id: "GL_MVP_t_ejb6_digital_sales_3.1_005"
				column: "g_final_contracting_channel_id"
				acceptanceMin: 100
				treatEmptyValuesAsNulls: true
				isCritical: true
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.NotNullValidationRule"
			config: {
				id: "GL_MVP_t_ejb6_digital_sales_3.1_006"
				column: "g_dig_sales_ct_ind_type"
				acceptanceMin: 100
				treatEmptyValuesAsNulls: true
				isCritical: true
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.FormatValidationRule"
			config: {
				id: "GL_MVP_t_ejb6_digital_sales_3.2_000"
				column: "g_country_id"
				format: "^.{1,2}$"
				acceptanceMin: 100
				isCritical: true
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.FormatValidationRule"
			config: {
				id: "GL_MVP_t_ejb6_digital_sales_3.2_001"
				column: "g_entity_id"
				format: "^.{1,6}$"
				acceptanceMin: 100
				isCritical: true
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.FormatValidationRule"
			config: {
				id: "GL_MVP_t_ejb6_digital_sales_3.2_002"
				column: "gf_entity_id"
				format: "^.{1,4}$"
				acceptanceMin: 100
				isCritical: true
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.FormatValidationRule"
			config: {
				id: "GL_MVP_t_ejb6_digital_sales_3.2_003"
				column: "g_contract_id"
				format: "^.{1,50}$"
				acceptanceMin: 100
				isCritical: true
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.FormatValidationRule"
			config: {
				id: "GL_MVP_t_ejb6_digital_sales_3.2_004"
				column: "g_init_contracting_channel_id"
				format: "^.{1,4}$"
				acceptanceMin: 100
				isCritical: true
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.FormatValidationRule"
			config: {
				id: "GL_MVP_t_ejb6_digital_sales_3.2_005"
				column: "g_final_contracting_channel_id"
				format: "^.{1,4}$"
				acceptanceMin: 100
				isCritical: true
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.FormatValidationRule"
			config: {
				id: "GL_MVP_t_ejb6_digital_sales_3.2_006"
				column: "g_dig_sales_ct_ind_type"
				format: "^.{1,1}$"
				acceptanceMin: 100
				isCritical: true
				withRefusals: true
			}
		},
		{
			class : "com.datio.hammurabi.rules.validity.StaticCatalogRule"
			config: {
				id: "GL_DOM_t_ejb6_digital_sales_3.5_000"
				column: "g_dig_sales_ct_ind_type"
				values: ["Y", "N"]
				acceptanceMin: 100
				isCritical: false
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.DynamicCatalogRule"
			config: {
				id: "2801aec1d5"
				column: "g_init_contracting_channel_id"
				dataValuesColumn: "gf_catalog_val_id"
				dataValuesSubset: "g_catalog_id ='C071' and gf_frequency_type='M'"
				dataValues: {
					type: "parquet"
					paths: ["/data/master/ktny/data/t_ktny_catalog_values_taxonomy/"]
					schema.path: ${ARTIFACTORY_UNIQUE_CACHE}"/artifactory/"${SCHEMAS_REPOSITORY}"/schemas/"${COUNTRY}"/ktny/master/t_ktny_catalog_values_taxonomy/latest/t_ktny_catalog_values_taxonomy.input.schema"
					options: {
 						overrideSchema: true
						includeMetadataAndDeleted: true 
					}
				}
				acceptanceMin: 100
				isCritical: false
				withRefusals: true
				subset: "g_init_contracting_channel_id is not null and g_init_contracting_channel_id != ''"
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.DynamicCatalogRule"
			config: {
				id: "2801aec24e"
				column: "g_final_contracting_channel_id"
				dataValuesColumn: "gf_catalog_val_id"
				dataValuesSubset: "g_catalog_id ='C071' and gf_frequency_type='M'"
				dataValues: {
					type: "parquet"
					paths: ["/data/master/ktny/data/t_ktny_catalog_values_taxonomy/"]
					schema.path: ${ARTIFACTORY_UNIQUE_CACHE}"/artifactory/"${SCHEMAS_REPOSITORY}"/schemas/"${COUNTRY}"/ktny/master/t_ktny_catalog_values_taxonomy/latest/t_ktny_catalog_values_taxonomy.input.schema"
					options: {
 						overrideSchema: true
						includeMetadataAndDeleted: true 
					}
				}
				acceptanceMin: 100
				isCritical: false
				withRefusals: true
				subset: "g_final_contracting_channel_id is not null and g_final_contracting_channel_id != ''"
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.DynamicCatalogRule"
			config: {
				id: "289cc78dc2"
				column: "g_init_contracting_channel_id"
				dataValuesColumn: "gf_catalog_val_id"
				dataValuesSubset: "g_catalog_id = 'C071' and gf_frequency_type='D'"
				dataValues: {
					type : "table"
					tables: [${?MASTERSCHEMA}".t_ktny_catalog_values_taxonomy"]
					options: {
						includeMetadataAndDeleted: true
					}
				}
				acceptanceMin: 100
				isCritical: false
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.DynamicCatalogRule"
			config: {
				id: "289cc78ebe"
				column: "g_final_contracting_channel_id"
				dataValuesColumn: "gf_catalog_val_id"
				dataValuesSubset: "g_catalog_id = 'C071' and gf_frequency_type='D'"
				dataValues: {
					type : "table"
					tables: [${?MASTERSCHEMA}".t_ktny_catalog_values_taxonomy"]
					options: {
						includeMetadataAndDeleted: true
					}
				}
				acceptanceMin: 100
				isCritical: false
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.DynamicCatalogRule"
			config: {
				id: "289cc78fc9"
				column: "gf_init_contracting_channel_id"
				dataValuesColumn: ${?CATALOG_COLUMN_0}
				dataValuesSubset: ${?CATALOG_CODE_0}
				dataValues: {
					type : "table"
					tables: [${?MASTERSCHEMA}"."${?CATALOG_TABLE_0}]
					options: {
						includeMetadataAndDeleted: true
					}
				}
				acceptanceMin: 100
				isCritical: false
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.DynamicCatalogRule"
			config: {
				id: "289cc790bb"
				column: "gf_final_contracting_channel_id"
				dataValuesColumn: ${?CATALOG_COLUMN_1}
				dataValuesSubset: ${?CATALOG_CODE_1}
				dataValues: {
					type : "table"
					tables: [${?MASTERSCHEMA}"."${?CATALOG_TABLE_1}]
					options: {
						includeMetadataAndDeleted: true
					}
				}
				acceptanceMin: 100
				isCritical: false
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.DynamicCatalogRule"
			config: {
				id: "289cc791a7"
				column: "g_ctrng_hu_asst_type"
				dataValuesColumn: "gf_catalog_val_id"
				dataValuesSubset: "g_catalog_id = 'F116' and gf_frequency_type='D'"
				dataValues: {
					type : "table"
					tables: [${?MASTERSCHEMA}".t_ktny_catalog_values_taxonomy"]
					options: {
						includeMetadataAndDeleted: true
					}
				}
				acceptanceMin: 100
				isCritical: false
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.StaticCatalogRule"
			config: {
				id:"28ada4d9a3"
				column: "g_dig_sales_ct_ind_type"
				values: ["Y", "N"]
				acceptanceMin: 100
				isCritical: false
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.consistence.DuplicateRule"
			config: {
				id: "GL_STR_t_ejb6_digital_sales_4.2_000"
				columns: ["g_country_id", "g_entity_id", "gf_entity_id", "gf_cutoff_date", "g_contract_id"]
				acceptanceMin: 100
				isCritical: true
				withRefusals: true
			}
		}
	]
}
