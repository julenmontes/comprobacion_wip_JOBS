hammurabi: {
	input: {
		type: "parquet"
		paths: ["/data/master/l9ct/data/t_l9ct_prod_assets_oilgas"]
		schema.path: ${ARTIFACTORY_UNIQUE_CACHE}"/artifactory/"${SCHEMAS_REPOSITORY}"/schemas/"${COUNTRY}"/l9ct/master/t_l9ct_prod_assets_oilgas/latest/t_l9ct_prod_assets_oilgas.output.schema"
		options: {
			overrideSchema: true
			includeMetadataAndDeleted: true
		}
	}

	dataFrameInfo: {
		cutoffDate: ${CUTOFF_DATE}
		subset: "gf_cutoff_date='"${CUTOFF_DATE}"'"
		uuaa: "l9ct"
		targetPathName: "/data/master/l9ct/data/t_l9ct_prod_assets_oilgas"
		physicalTargetName: "t_l9ct_prod_assets_oilgas"
	}

	rules: [
		{
			class: "com.datio.hammurabi.rules.validity.NotNullValidationRule"
			config: {
				id: "GL_MVP_t_l9ct_prod_assets_oilgas_3.1_000"
				column: "gf_asset_external_data_id"
				acceptanceMin: 100
				treatEmptyValuesAsNulls: true
				isCritical: true
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.NotNullValidationRule"
			config: {
				id: "GL_MVP_t_l9ct_prod_assets_oilgas_3.1_001"
				column: "gf_asset_type"
				acceptanceMin: 100
				treatEmptyValuesAsNulls: true
				isCritical: true
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.FormatValidationRule"
			config: {
				id: "GL_MVP_t_l9ct_prod_assets_oilgas_3.2_000"
				column: "gf_asset_external_data_id"
				format: "^.{1,50}$"
				acceptanceMin: 100
				isCritical: true
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.FormatValidationRule"
			config: {
				id: "GL_MVP_t_l9ct_prod_assets_oilgas_3.2_001"
				column: "gf_asset_type"
				format: "^.{1,20}$"
				acceptanceMin: 100
				isCritical: true
				withRefusals: true
			}
		},
	    {
			class: "com.datio.hammurabi.rules.validity.NumericRangeRule"
			config {
				id: "2891f1b96c"
				column: "gf_1p_reserves_number"
				lowerBound: 0.0
				acceptanceMin: 95
				isCritical: false
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.NumericRangeRule"
			config {
				id: "2891f1ba8c"
				column: "gf_2p_reserves_number"
				lowerBound: 0.0
				acceptanceMin: 95
				isCritical: false
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.NumericRangeRule"
			config {
				id: "2891f1bb92"
				column: "gf_3p_reserves_number"
				lowerBound: 0.0
				acceptanceMin: 95
				isCritical: false
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.DynamicCatalogRule"
			config {
				id: "2891f1b761"
				column: "g_produced_resource_type"
				dataValuesColumn: "gf_catalog_val_id"
				dataValues {
					type: "table"
					tables: [${MASTERSCHEMA}".t_ktny_catalog_values_taxonomy"]

				options {
					overrideSchema: true
					includeMetadataAndDeleted: true
				}
				}
				acceptanceMin: 95
				isCritical: false
				withRefusals: true
				dataValuesSubset: "gf_frequency_type='D' and g_catalog_id ='E760'"
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.DynamicCatalogRule"
			config {
				id: "2891f1b85b"
				column: "g_asset_dev_stages_type"
				dataValuesColumn: "gf_catalog_val_id"
				dataValues {
					type: "table"
					tables: [${MASTERSCHEMA}".t_ktny_catalog_values_taxonomy"]

				options {
					overrideSchema: true
					includeMetadataAndDeleted: true
				}
				}
				acceptanceMin: 95
				isCritical: false
				withRefusals: true
				dataValuesSubset: "gf_frequency_type='D' and g_catalog_id ='E132'"
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.DynamicCatalogRule"
			config: {
				id:"28ada4e021"
				column: "gf_asset_type"
				dataValuesColumn: "gf_catalog_val_id"
				dataValuesSubset: "g_catalog_id = 'D982' and gf_frequency_type='M'"
				dataValues: {
					type : "table"
					tables: [${?MASTERSCHEMA}".t_ktny_catalog_values_taxonomy"]
					options: {
						includeMetadataAndDeleted: true
					}
				}
				acceptanceMin: 100
				isCritical: false
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.DynamicCatalogRule"
			config: {
				id:"28ada4e0ef"
				column: "g_produced_resource_type"
				dataValuesColumn: "gf_catalog_val_id"
				dataValuesSubset: "g_catalog_id = 'E760' and gf_frequency_type='M'"
				dataValues: {
					type : "table"
					tables: [${?MASTERSCHEMA}".t_ktny_catalog_values_taxonomy"]
					options: {
						includeMetadataAndDeleted: true
					}
				}
				acceptanceMin: 100
				isCritical: false
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.validity.DynamicCatalogRule"
			config: {
				id:"28ada4e1cd"
				column: "g_asset_dev_stages_type"
				dataValuesColumn: "gf_catalog_val_id"
				dataValuesSubset: "g_catalog_id = 'E132' and gf_frequency_type='M'"
				dataValues: {
					type : "table"
					tables: [${?MASTERSCHEMA}".t_ktny_catalog_values_taxonomy"]
					options: {
						includeMetadataAndDeleted: true
					}
				}
				acceptanceMin: 100
				isCritical: false
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.consistence.DuplicateRule"
			config: {
				id: "GL_STR_t_l9ct_prod_assets_oilgas_4.2_000"
				columns: ["gf_cutoff_date", "gf_information_source_id","gf_asset_external_data_id", "gf_asset_type"]
				acceptanceMin: 100
				isCritical: true
				withRefusals: true
			}
		},
	    {
			class: "com.datio.hammurabi.rules.integrity.SameValueComparisonRule"
			config {
				id: "2891f1bcaa"
				column: "gf_cutoff_date" 
				condition: "gf_cutoff_date <= current_timestamp()"
				acceptanceMin: 95
				isCritical: false
				withRefusals: true
			}
		},
		{
			class: "com.datio.hammurabi.rules.integrity.SameValueComparisonRule"
			config {
				id: "2891f1bdc0"
				column: "gf_audit_date"
				condition: "gf_audit_date <= current_timestamp()" 
				acceptanceMin: 95
				isCritical: false
				withRefusals: true
			}
		}
	]
}